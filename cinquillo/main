# main.py (o el nombre que prefieras)

from cinquillo.motor import MotorJuego
from cinquillo.bot_jugador import BotJugador
from cinquillo.jugador_humano import JugadorHumano  # <- el que creamos antes

def main():
    print("🎮 Bienvenido al Cinquillo contra un Bot\n")

    # Crear jugadores
    jugadores = [
        JugadorHumano("Tú"),        # Jugador humano
        BotJugador("Bot1")          # Bot jugador automático
    ]

    # Crear motor de juego
    motor = MotorJuego()
    motor.nueva_partida(jugadores)

    # Mostrar manos iniciales
    print("\n🃏 Manos iniciales:")
    for jugador in jugadores:
        print(f"{jugador.nombre}: {[str(carta) for carta in sorted(jugador.mano, key=lambda c: (c.palo, c.valor))]}")

    # Jugar turnos
    while not motor.partida.finalizada:
        jugador = motor.partida.jugadores[motor.partida.turno_actual]
        print(f"\n🔄 Turno de {jugador.nombre}")

        if jugador.tiene_jugada_valida(motor.partida.mesa):
            carta = jugador.jugar(motor.partida.mesa)
            if carta:
                motor.partida.mesa.colocar_carta(carta)
                motor.partida.historial.append((jugador.nombre, carta))
                print(f"🃏 {jugador.nombre} juega: {carta}")
        else:
            print(f"⏭ {jugador.nombre} pasa (sin jugada válida)")

        # Comprobar si alguien se quedó sin cartas
        if any(len(j.mano) == 0 for j in motor.partida.jugadores):
            motor.partida.finalizada = True
            break

        motor.partida.siguiente_turno()

    # Mostrar resultados
    print("\n🏁 ¡Partida finalizada!")
    for jugador in jugadores:
        print(f"{jugador.nombre} - Cartas restantes: {len(jugador.mano)}")
    ganadores = [j for j in jugadores if len(j.mano) == 0]
    if ganadores:
        print(f"🏆 Ganador(es): {', '.join(j.nombre for j in ganadores)}")
    else:
        print("🤷 No hubo ganadores (empate técnico)")

if __name__ == "__main__":
    main()
